---
title: 'Muerte de mujeres ocasionada por su pareja o expareja íntima'
output: 
html_document: 
  toc: yes
  toc_depth: 2
date: "2023-06-14"
---

Para está investigación, utilizamos la data proporcionada por el sitio web de la Comisión Económica para América Latina y el Caribe (CEPAL) que es una de las cinco comisiones regionales de las Naciones Unidas y su sede está en Santiago de Chile. Cuya investigación trata de gráficar y analizar las Muertes de mujeres ocacionadas por su pareja o expareja íntima sobre 28 países de Latinoamérica y de la Península Ibérica. Además, los datos abarcan un período de 20 años, el cuál inicia en 2001 y finaliza en 2021.

Para comenzar, lo primero que hicimos fue limpiar la data. Para ello realizamos lo siguiente:
***Librerías necesarias***
```{r}
library(readxl)
library(tidyverse)
library(tidyr)
library(cowplot)
```

***Ver en qué directorio en donde nos encontramos***
```{r}
getwd()
```

***Leer el excel de nuestra data***
```{r}
data <- read_excel("BaseDeDatosOriginal.xlsx")
```

***Ver nuestra la cabecera que esta en la variable data***
```{r}
head(data)
```

***Cambiar el encabezado de la tabla para una mejor lectura:***
```{r}
data<- data %>% rename(valor = value) %>% rename(tipodevalor = Tipodevalor) %>% rename(paises = País__ESTANDAR) %>% rename(anio = Años__ESTANDAR)

```

***Ver nuestra data que esta en la variable data***
```{r}
head(data)
```


***Seleccionando las variables de interés y ordenar por anio***
**Seleccionamos solo paises, año, valor y tipodevalor porque son las variables de interés para esta investigación**
```{r}
data <- data %>% select(paises, anio, valor, tipodevalor) %>% arrange(anio)
```

***Ver nuestra data que esta en la variable data***
```{r}
head(data, 10)
```

***Quitar los na de la tabla***
**Ya que son valores que no se encontrar al recoger la data**
```{r}
data<- na.omit(data)
```

***Ver nuestra data que esta en la variable data***
```{r}
head(data, 10)
```

***Ver la variable valores no modificada***
```{r}
head(data$valor, 10)
```

***Redondear la variable valor a dos decimales***
```{r}
data$valor<- round(data$valor, 2)
```

***Ver la variable valores modificada***
```{r}
head(data$valor, 10)
```
**Gráficas:**
***Comparamos entre los dos tipos de valores que tenemos, es decir, Número Absoluto y tasa por cada 100 mujeres***
***Los cuales son dos tipos de forma de ver los datos***
***El primer gráfico nos muestra la data en funcion al Tipo "Número Absoluto"***

```{r}
grafico1 <- data %>% filter(tipodevalor == "Número absoluto") %>%
ggplot(aes(x = anio, y = valor, fill = tipodevalor)) +
  geom_bar(stat = "identity") +
  xlab("Años (2001-2021)") +
  ylab("Número de muertes de mujer") +
  ggtitle("Muertes de mujeres ocasionadas por su pareja y ex-pareja") +
  scale_y_continuous(limits=c(0, max(data$valor)))
```

***El segundo gráfico nos muestra la data en funcion al Tipo "Tasa(por cada 100.000 mujeres)"***

```{r}
grafico2 <- data %>% filter(tipodevalor == "Tasa (por cada 100.000 mujeres)") %>%
  ggplot(aes(x = anio, y = valor, fill = tipodevalor))  +
  geom_bar(stat = "identity") +
  xlab("Años (2001-2021)") +
  ylab("Número de muertes de mujer") + 
  ggtitle("Muertes de mujeres ocasionadas por su pareja y ex-pareja") +
  scale_y_continuous(limits=c(0, max(data$valor)))
```

Con la ayuda de las gráficas podemos entender un poco el significado de los dos tipos de datos que se muestran, es decir, el Número Absoluto y la tasa por cada 100.000 mujeres. Concluimos que, aunque ambos nos muestran lo mismo, visualmente son diferentes. La más visual es la de Número Absoluto, ya que nos permite ver los países que tienen una mayor cantidad de muertes en un año específico. En cambio, el otro nos muestra por año la cantidad de muertes que hay por cada 100.000 mujeres en el pais.

***Mostramos ambo gráfico para posteriormente analizar que es lo que podemos notar en él***
```{r data, echo=FALSE}
gridExtra::grid.arrange(grafico1, grafico2, newpage = TRUE, nrow= 2)
```

***Gráficas de línea:***
***Se visualizarán los datos en un par de gráficas de línea que muestran la tendencia en las muertes de mujeres ocasionadas por parejas y ex-parejas***
Se utilizará una paleta de colores que permita la mejor visualización de las líneas:
```{r}
colors_vec <- c("#4d4dff", "#00b3b3", "#00cc99", "#b3b300", "#b35900", "#cc99cc", "#ff4d4d", "#808080", "#ff9933", "#6666ff", "#00e6e6", "#b3b3b3", "#ff66ff", "#ffcc99", "#99ff99", "#ff6666", "#b3b300", "#00b3b3", "#ff99cc", "#6666ff", "#ffcc00", "#cc00cc", "#ff4d4d", "#00cc00", "#b35900", "#4d4dff", "#808080", "#FF9933", "#99E6E6", "#FF99CC", "#6666FF", "#FFCC70", "#CC00CC")
names(colors_vec) <- c("Costa Rica", "Trinidad y Tabago", "San Vicente y las Granadinas", "Colombia", "España", "Granada", "Jamaica", "Nicaragua", "Puerto Rico", "República Dominicana", "Santa Lucía", "Suriname", "Dominica", "Saint Kitts y Nevis", "Islas Vírgenes Británicas", "Anguila", "Antigua y Barbuda", "Guyana", "Montserrat", "Chile", "Paraguay", "Uruguay", "Perú", "Honduras", "Barbados", "Belice", "El Salvador", "Argentina", "Venezuela (República Bolivariana de)", "Ecuador", "Portugal", "Cuba", "Panamá")
```

***La primera gráfica muestra la tendencia del número de muertes***
```{r}
line_absoluto = data %>%
  filter(tipodevalor == 'Número absoluto') %>%
  ggplot(aes(x = anio, y = valor, color = paises)) +
  geom_line(aes(group = paises)) +
  scale_color_manual(values = colors_vec) +
  labs(title = "Tendencia en numero de muertes de mujeres ocasionadas por parejas y  ex-parejas",
       x = "Años (2001-2021)",
       y = "Numero de muertes") 
```

***La segunda gráfica muestra la tendencia de la tasa de muertes cada 100.000 mujeres***
```{r}
line_tasa = data %>%
  filter(tipodevalor == 'Tasa (por cada 100.000 mujeres)') %>%
  ggplot(aes(x = anio, y = valor, color = paises)) +
  geom_line(aes(group = paises)) +
  scale_color_manual(values = colors_vec) +
  labs(title = "Tendencia en la tasa de muertes de mujeres ocasionadas por parejas y  ex-parejas",
       x = "Años (2001-2021)",
       y = "Tasa (por cada 100.000 mujeres)") 
```

El numero de muertes de mujeres por parejas o ex-parejas en muchos paises va aumentando, o mantienen cierta estabilidad, es decir, suben y bajan muy poco. Es interesante destacar que algunos países con altos números de muertes de mujeres por parte de sus parejas o ex-parejas pueden tener tasas relativamente bajas de muertes por cada 100.000 habitantes debido a su población femenina más grande. Sin embargo, esto no significa que la violencia de género sea menos prevalente o menos grave en estos países.

***Se muestran ambas gráficas para su análisis***
```{r, echo=FALSE}
legend = get_legend(line_tasa + theme(legend.text = element_text(size = 6)))
gridExtra::grid.arrange(line_absoluto + theme(legend.position = 'none', plot.title = element_blank()), line_tasa + theme(legend.position = 'none', plot.title = element_blank()), left = NULL, right = legend, newpage = TRUE, top = NULL, bottom = NULL)
```



